@{
    ViewBag.Title = "Crear/Modificar Periodo Requermiento";
    Model.PeriodoSolicitud periodoSolicitud = ViewBag.periodoSolicitud;


    var textBoxFechaInicio = Html.TextBoxFor(c => periodoSolicitud.fechaInicioFormato, htmlAttributes:  new { @class = "form-control" });

    if(!periodoSolicitud.idPeriodoSolicitud.Equals(Guid.Empty))
    {
        if (DateTime.Compare(periodoSolicitud.fechaInicio, DateTime.Now) < 0)
        {
            textBoxFechaInicio = Html.TextBoxFor(c => periodoSolicitud.fechaInicioFormato, htmlAttributes:  new { @class = "form-control", @disabled = "disabled"  });
        }

    }
}

<div class="page-header">
    <h3>@ViewBag.Title</h3>
</div>

<div class="container">
    <input type="hidden" id="pagina" value="@ViewBag.pagina" />
    <input type="hidden" value="@ViewBag.debug" />
    <form class="form-horizontal">
        <div class="row">
            <input type="hidden" id="idPeriodoSolicitud" name="idPeriodoSolicitud" value="@periodoSolicitud.idPeriodoSolicitud" />

            <div class="row">
                <div class="col-sm-12 col-lg-8">
                    <div class="form-group">
                        @Html.LabelFor(dv => periodoSolicitud.nombre, htmlAttributes: new { @class = "control-label col-xs-3" })
                        <div class="col-xs-9">
                            @Html.TextBoxFor(c => periodoSolicitud.nombre, htmlAttributes: new { @class = "form-control" })
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-12 col-lg-8">
                    <div class="form-group">
                        @Html.LabelFor(dv => periodoSolicitud.fechaInicio, htmlAttributes: new { @class = "control-label col-xs-3" })
                        <div class="col-xs-9">
                            @textBoxFechaInicio
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-12 col-lg-8">
                    <div class="form-group">
                        @Html.LabelFor(dv => periodoSolicitud.fechaFin, htmlAttributes: new { @class = "control-label col-xs-3" })
                        <div class="col-xs-9">
                            @Html.TextBoxFor(c => periodoSolicitud.fechaFinFormato, htmlAttributes: new { @class = "form-control" })
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-12 col-lg-8">
                    <div class="form-group">
                        @Html.LabelFor(dv => periodoSolicitud.Estado, htmlAttributes: new { @class = "control-label col-xs-3" })
                        <div class="col-xs-9">
                            <select id="periodoSolicitud_Estado" class="form-control">
                                <option value="1">Inactivo</option>
                                <option value="2">Activo</option>
                                <option value="10">Cerrado</option>
                            </select>
                        </div>
                        <script>
                            document.addEventListener('DOMContentLoaded', function () {
                                $("#periodoSolicitud_Estado").val("@periodoSolicitud.Estado");
                            }, false);
                        </script>
                    </div>
                </div>
            </div>
        </div>


       
            <div class="row">
                <div class="col-sm-6 col-lg-6">
                    <div class="onoffswitch">
                        <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="chkSoloCanasta">
                        <label class="onoffswitch-label" for="chkSoloCanasta"></label>
                    </div>
                    <h5 id="lblChkCanasta" style="width: 80%; margin-left: 45px; margin-top: -22px; font-weight:bold; cursor:pointer;" class="text-muted">Ver solo canasta de este periodo</h5>

                </div>
            </div>


            <table id="tableListaPrecios" class="table" data-editing="false"
                   data-editing-allow-add="false"
                   data-editing-allow-delete="false"
                   data-editing-allow-edit="false"
                   data-show-toggle="false">
                <thead>
                    <tr>
                        <th data-name="idProducto" data-visible="false"></th>
                        <th data-name="canasta" class="listaPreciosCanasta" data-sortable="false">
                         <input type="checkbox" class="chkCanastaAll">
                        Pertenece <br />Canasta</th>
                        <th data-name="proveedor" data-sortable="false">Prov.</th>
                        <th data-name="codigo" data-sortable="false" data-breakpoints="xs">Código</th>
                        <th data-name="producto" data-sortable="false">Producto / Descripción</th>
                        <th data-name="presentacion" data-sortable="false" data-breakpoints="xs">Unidad</th>
                        <th data-name="imagen" data-sortable="false" data-breakpoints="xs sm">Imagen</th>
                    </tr>
                </thead>
                <tbody>                    
                    @foreach (Model.DocumentoDetalle itemCanasta in periodoSolicitud.canasta)
                    {
                    <tr data-expanded="true">
                        <td>  @itemCanasta.producto.idProducto  </td>
                        <td>
                            @{var checkedCanasta = ""; }
                            @if (itemCanasta.producto.precioClienteProducto.estadoCanasta)
                            {
                                checkedCanasta = "checked";
                            }
                            <input type="checkbox" class="chkCanasta" idProducto=@itemCanasta.producto.idProducto @checkedCanasta>


                        </td>
                        <td>  @itemCanasta.producto.proveedor  </td>
                        <td>  @itemCanasta.producto.sku  </td>
                        <td>  @itemCanasta.producto.descripcion  </td>
                        <td>  @itemCanasta.unidad  </td>

                        <td class="column-img"><img class="table-product-img" src="data:image/png;base64,@Convert.ToBase64String(itemCanasta.producto.image)"></td>

                    </tr>


                    }
                </tbody>
            </table>
        

        <div class="row">
            <div class="pull-right">
                <button type="button" id="btnCancelarPeriodoSolicitud" class="btn btn-danger">Cancelar</button>
                <button id="btnFinalizarEdicionPeriodoSolicitud" type="button" class="btn btn-success">Finalizar Creación</button>
            </div>
        </div>

    </form>
</div>



@section Scripts {
    @Scripts.RenderFormat("<script type=\"text/javascript\" src=\"{0}?nocache=" + TempData["ScriptVersion"] + "\"></script>", "~/bundles/periodoSolicitud")
}