
<div class="modal fade" tabindex="-1" id="modalStockProductoSedes">
    <div class="modal-dialog">

        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="modalMostrarPreciosTitle"><b>Stock de producto en la Sede </b></h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <p></p>
            </div>

            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-6 col-lg-8">
                        <div class="form-group">
                            <label class="control-label col-xs-2">Producto:</label>
                            <div class="col-xs-10">
                                <span class="form-control-static" id="verNombreProductoStock"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-4">
                        <div class="form-group">
                            <label class="control-label col-xs-4">Código:</label>
                            <div class="col-xs-8">
                                <span class="form-control-static" id="verCodigoProductoStock"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-8">
                        <div class="form-group">
                            <label class="control-label col-xs-2">Unidad:</label>
                            <div class="col-xs-10">
                                <span class="form-control-static" id="verUnidadProductoStock"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-12 col-lg-12">
                        <div class="form-group">
                            <label for="numero" class="control-label col-xs-4">Stock en la Sede(<span id="verNombreSedeProductoStock"></span>):</label>

                            <div class="col-xs-8">
                                <span class="form-control-static text-center" id="verStockSedeProducto"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-12 col-lg-12">
                        <h4><b>Stock en otras sedes: </b></h4>
                    </div>
                </div>

                <div class="row" id="divStockProductoOtrasSedes">
                </div>
            </div>

        </div>
    </div>
</div>

<script type="text/javascript">
    window.onload = function () {
        $(document).on('click', "button.verModalStockProducto", function () {
            var idCiudad = $(this).attr("idCiudad");
            var sku = $(this).attr("sku");
            var idProductoPresentacion = $(this).attr("idProductoPresentacion");

            $.ajax({
                url: "/Stock/ReporteStockProducto",
                type: 'POST',
                dataType: 'JSON',
                data: {
                    idCiudad: idCiudad,
                    sku: sku
                },
                success: function (lista) {
                    var htmlStockSedes = "";
                    var stock;
                    for (var i = 0; i < lista.length; i++) {
                        stock = 0;
                        if (lista[i].ciudad.idCiudad == idCiudad) {
                            $("#verNombreSedeProductoStock").html(lista[i].ciudad.nombre);
                            

                            $("#verNombreProductoStock").html(lista[i].producto.descripcion);
                            $("#verCodigoProductoStock").html(lista[i].producto.sku);

                            if (lista[i].stockNoDisponible) {
                                stock = "No Disponible";
                            } else {
                                if (idProductoPresentacion == '0') {
                                    stock = lista[i].cantidadMpCalc;
                                    $("#verUnidadProductoStock").html(lista[i].producto.unidad);
                                }
                                if (idProductoPresentacion == '1') {
                                    stock = lista[i].cantidadAlternativaCalc;
                                    $("#verUnidadProductoStock").html(lista[i].producto.unidad_alternativa);
                                }
                                if (idProductoPresentacion == '2') {
                                    stock = lista[i].cantidadProveedorCalc;
                                    $("#verUnidadProductoStock").html(lista[i].producto.unidadProveedor);
                                }
                            }
                            $("#verStockSedeProducto").html(stock);
                        } else {
                            if (lista[i].stockNoDisponible) {
                                stock = "No Disponible";
                            } else {
                                if (idProductoPresentacion == '0') {
                                    stock = lista[i].cantidadMpCalc;
                                }
                                if (idProductoPresentacion == '1') {
                                    stock = lista[i].cantidadAlternativaCalc;
                                }
                                if (idProductoPresentacion == '2') {
                                    stock = lista[i].cantidadProveedorCalc;
                                }
                            }

                            var htmlStockSedes = htmlStockSedes + '<div class="col-sm-4 col-lg-4"><div class="form-group"><label class="control-label col-xs-8">' +
                                lista[i].ciudad.nombre + '</label><div class="col-xs-4"><span class="form-control-stati">' + stock + '</span></div></div></div>';
                        }
                    }

                    $("#divStockProductoOtrasSedes").html(htmlStockSedes);

                    $("#modalStockProductoSedes").modal();
                }
            });
        });
    };
</script>
