@{
    ViewBag.Title = "Búsqueda Clientes";
    Model.Cliente cliente = ViewBag.cliente;
    List<Model.Cliente> clienteList = ViewBag.clienteList;
}

<div class="page-header">
    <h3>@ViewBag.Title</h3>
</div>
<div class="container">
    <input type="hidden" id="idPedido" value="" />
    <input type="hidden" id="pagina" value="@ViewBag.pagina" />

    <form class="form-horizontal">

        <div class="row">
            <!--codigo
        <div class="col-sm-6 col-lg-4">
            <div class="form-group">
                @Html.LabelFor(c => cliente.codigo, htmlAttributes: new { @class = "control-label col-xs-4" })
                <div class="col-xs-8">
                    @Html.TextBoxFor(c => cliente.codigo, htmlAttributes: new { @class = "form-control", type = "number", min = "0" })
                    <span style="margin-right: 20px; font-size:12px; color: darkred; font-weight: normal " class="has-error">*Si ingresa el código los otros criterios no serán considerados en la búsqueda.</span>
                </div>
            </div>
        </div>-->
            <!--CIUDAD-->
            <div class="col-sm-6 col-lg-4">
                <div class="form-group">
                    @Html.LabelFor(c => cliente.ciudad, htmlAttributes: new { @class = "control-label col-xs-4", @for = "idCiudad" })
                    <div class="col-xs-8">
                        @Html.Action("GetCiudades", "Ciudad",
                                                                               new
                                                                               {
                                                                                   ciudadSelectId = "idCiudad",
                                                                                   selectedValue = cliente.ciudad.idCiudad
                                                                               })
                    </div>
                </div>
            </div>

            <div class="col-sm-6 col-lg-4">
                <!--Cliente-->
                <div class="form-group">
                    <label for="idCliente" class="control-label col-xs-4">Cliente:</label>

                    <div class="col-xs-8">
                        <select class="form-control input-sm" id="idCliente" name="idCliente" required>
                            @if (ViewBag.existeCliente == 1)
                        {
                            <option selected value="@cliente.idCliente">@cliente</option>
                    }
                    else
                    {
                        <option value=""></option>
                }
                        </select>
                    </div>
                </div>

            </div>
        </div>


        <div class="row">
            <!--Responsable Comercial-->
            <div class="col-sm-6 col-lg-4">
                <div class="form-group">
                    @Html.LabelFor(c => cliente.responsableComercial, htmlAttributes: new { @class = "control-label col-xs-4", @for = "idResponsableComercial" })
                    <div class="col-xs-8">
                        @Html.Action("GetResponsablesComerciales", "Vendedor",
                                 new
                                 {
                                     vendedorSelectId = "idResponsableComercial",
                                     selectedValue = cliente.responsableComercial.idVendedor,
                                 })

                    </div>
                </div>
            </div>
            <!--Supervisor Comercial-->
            <div class="col-sm-6 col-lg-4">
                <div class="form-group">
                    @Html.LabelFor(c => cliente.supervisorComercial, htmlAttributes: new { @class = "control-label col-xs-4", @for = "idSupervisorComercial" })
                    <div class="col-xs-8">
                        @if (cliente.usuario.defineSupervisorComercial)
                    {
                        @Html.Action("GetSupervisoresComerciales", "Vendedor",
                           new
                           {
                               vendedorSelectId = "idSupervisorComercial",
                               selectedValue = cliente.supervisorComercial.idVendedor,
                           })
                }
                else
                {
                    @Html.Action("GetSupervisoresComerciales", "Vendedor",
                       new
                       {
                           vendedorSelectId = "idSupervisorComercial",
                           selectedValue = cliente.supervisorComercial.idVendedor,
                           disabled = "disabled"
                       })
            }
                    </div>
                </div>
            </div>
            <!--Asistente Servicio al Cliente-->
            <div class="col-sm-6 col-lg-4">
                <div class="form-group">
                    @Html.LabelFor(c => cliente.asistenteServicioCliente, htmlAttributes: new { @class = "control-label col-xs-4", @for = "idSupervisorComercial" })
                    <div class="col-xs-8">
                        @if (cliente.usuario.defineAsistenteAtencionCliente)
                        {
                            @Html.Action("GetAsistentesServicioCliente", "Vendedor",
                                    new
                                    {
                                        vendedorSelectId = "idAsistenteServicioCliente",
                                        selectedValue = cliente.asistenteServicioCliente.idVendedor,
                                    })
                        }
                        else
                        {
                            @Html.Action("GetAsistentesServicioCliente", "Vendedor",
                               new
                               {
                                   vendedorSelectId = "idAsistenteServicioCliente",
                                   selectedValue = cliente.asistenteServicioCliente.idVendedor,
                                   disabled = "disabled"
                               })
                        }
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
             <div class="col-sm-6 col-lg-4">
                    <div class="form-group">
                        @Html.LabelFor(dv => cliente.tipoPagoFactura, htmlAttributes: new { @class = "control-label col-xs-4 col-lg-4" })
                        <div class="col-xs-8">
                        @if (cliente.usuario.apruebaPlazoCredito)
                        {

                                @Html.DropDownList("tipoPagoCliente",
                                            EnumHelper.GetSelectList(typeof(Model.DocumentoVenta.TipoPago), cliente.tipoPagoFactura),
                                            new { @class = "form-control" }
                                            )  
                        }
                        else
                        {
                                @Html.DropDownList("tipoPagoCliente",
                                            EnumHelper.GetSelectList(typeof(Model.DocumentoVenta.TipoPago), cliente.tipoPagoFactura),
                                            new { @class = "form-control", @disabled = "disabled" }
                                            )
                        }
                    </div>
                </div>
            </div>

             <!--Considerar Bloqueados-->
             <div class="col-sm-6 col-lg-4">
                <div class="form-group">
                    <label for="cliente_bloqueado" class="control-label col-xs-4">¿Considerar solo bloqueados?:</label>
                    <div class="col-xs-8">
                        <div class="radio radio-inline">
                            <label class="radio-label">
                                @if (cliente.bloqueado)
                                {
                                    <input class="radio-input" checked type="radio" name="cliente_bloqueado" id="bloqueadosi" value="1">@ViewBag.Si;
                                }
                                else
                                {
                                    <input class="radio-input" type="radio" name="cliente_bloqueado" id="bloqueadosi" value="1">@ViewBag.Si;
                                }

                            </label>
                        </div>
                        <div class="radio radio-inline">
                            <label class="radio-label">
                                @if (!cliente.bloqueado)
                                {
                                    <input class="radio-input" checked type="radio" name="cliente_bloqueado" id="bloqueadono" value="0">@ViewBag.No;
                                }
                                else
                                {
                                    <input class="radio-input" type="radio" name="cliente_bloqueado" id="bloqueadono" value="0">@ViewBag.No;
                                }
                            </label>
                        </div>
                    </div>
                </div>
            </div>
       
        </div>


        <div class="row pull-right" style="margin-bottom:10px; margin-right:0px">
            <button id="btnLimpiarBusquedaPedidos" type="button" class="btn btn-primary  bouton-image botonClean">Limpiar</button>
            <button id="btnBusquedaPedidos" type="button" class="btn btn-primary  bouton-image botonSearch">Buscar</button>
        </div>

        <table id="tableClientes" class="table" data-editing="false" data-paging="true" data-paging-count-format="{CP} de {TP}"
               data-editing-show-text='<span class="fooicon fooicon-pencil" aria-hidden="true"></span> Editar Detalle'
               data-editing-allow-add="false"
               data-editing-allow-delete="false"
               data-editing-allow-edit="false"
               data-sorting="true"
               data-show-toggle="false"
               data-editing-hide-text="Finalizar edición"
               data-editing-add-text="Descartar cambios">
            <thead>
                <tr>
                    <th data-name="idCliente" data-visible="false"></th>
                    <th data-name="codigo" data-visible="true">Código</th>
                    <th data-name="sedeMP" data-sortable="false" data-breakpoints="xs">Sede MP</th>
                    <th data-name="nombre" data-visible="true" data-sortable="true">Nombre</th>
                    <th data-name="nombreComercial" data-visible="true" data-sortable="true">Asesor Comercial</th>
                    <th data-name="nombreComercial" data-visible="true" data-sortable="true">Supervisor Comercial</th>
                    <th data-name="nombreComercial" data-visible="true" data-sortable="true">Asistente Servicio Cliente</th>
                    <th data-name="nombreComercial" data-visible="true" data-sortable="true">Plazo Crédito Aprobado</th>
                    <th data-name="nombreComercial" data-visible="true" data-sortable="true">Monto Crédito Aprobado</th>
                    <th data-name="nombreComercial" data-visible="true" data-sortable="true">Bloqueado</th>
                    <th data-name="opciones" data-sortable="true" data-breakpoints="xs"></th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>       
    </form>
</div>


<div class="modal fade" id="modalVerCliente" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="modalVerCliente"><b>Información de Cliente</b></h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <p></p>
            </div>


            <div class="modal-body">
                <form class="form-horizontal">
                    <input type="hidden" id="verIdCliente" />
                    
                    <div class="row">
                        <!--NÚMERO PEDIDO-->
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(c => cliente.codigo, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verNumero"></p>
                                </div>
                            </div>
                        </div>               


                    </div>


                    <fieldset>
                        <legend id="divpedido_direccionEntrega">Estado Crediticio del Pedido:</legend>
                        <div class="row">
                            <!--Estado-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    <label for="estado" class="control-label col-xs-4">Estado:</label>
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verEstadoCrediticio"></p>
                                    </div>
                                </div>
                            </div>
                            <!--Modificado POR-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    <label for="modificado" class="control-label col-xs-4">Modificado Por:</label>
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verModificadoCrediticioPor"></p>
                                    </div>
                                </div>
                            </div>
                            <!--Observación Estado-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    <label for="modificado" class="control-label col-xs-4">Comentario Estado:</label>
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verObservacionEstadoCrediticio">
                                        </p>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </fieldset>


                </form>
            </div>

            <div class="modal-footer">

                <div class="pull-right">
                    <button type="button" id="btnCancelarVerCliente" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                    <button type="button" id="btnEditarCliente" class="btn btn-primary ">Editar</button>
                </div>

            </div>


        </div>
    </div>
</div>

@section Scripts {
    @Scripts.Render("~/bundles/cliente")
}
