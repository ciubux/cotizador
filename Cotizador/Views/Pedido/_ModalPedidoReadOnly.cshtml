@{
    Model.Pedido vPed = new Model.Pedido();


    vPed.usuario = ViewBag.usuario;

    bool agregadoPedidoModals = false;
    if(ViewBag.vistaAgregadoPedidoModals != null)
    {
        agregadoPedidoModals = ViewBag.vistaAgregadoPedidoModals;
    }
}

<div class="modal fade" id="modalPedidoReadOnly" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="modalPedidoReadOnlyTitle"><b>Información de Pedido Venta</b></h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <p></p>
            </div>


            <div class="modal-body">
                <form class="form-horizontal">
                    <input type="hidden" id="verMROIdPedido" />
                    <input type="hidden" id="verMROIdCliente" />
                    <input type="hidden" id="verMROFechaEntregaExtendida" />
                    <!--NUMEROS PEDIDO-->
                    <div class="row">
                        <!--NÚMERO PEDIDO-->
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.numeroPedido, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMRONumero"></p>
                                </div>
                            </div>
                        </div>
                        <!--NUMERO PEDIDO GRUPO
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.numeroGrupoPedido, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMRONumeroGrupo"></p>
                                </div>
                            </div>
                        </div>-->
                        <!--NUMERO COTIZACION-->
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.cotizacion.codigo, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMROCotizacionCodigo"></p>
                                </div>
                            </div>
                        </div>


                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.tipoPedido, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMROTipoPedido"></p>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!--DATOS DEL CLIENTE-->
                    <div class="row">
                        <!--CIUDAD-->
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.ciudad, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMROCiudad"></p>
                                </div>
                            </div>
                        </div>
                        <!--CLIENTE-->
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.cliente, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMROCliente"></p>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                <label for="estado" class="control-label col-xs-4">Grupo Cliente:</label>
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMROGrupoCliente"></p>
                                </div>
                            </div>
                        </div>



                    </div>


                    <div class="row" id="divReferenciaCliente">
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.numeroReferenciaCliente, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMRONumeroReferenciaCliente"></p>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.numeroRequerimiento, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMRONumeroRequerimiento"></p>
                                </div>
                            </div>
                        </div>

                    </div>



                    <!--DATOS DE LA CREACIÓN-->
                    <div class="row">
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.usuarioCreacion, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMROUsuarioCreacion"></p>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.fechaHoraRegistro, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMROFechaHoraRegistro"></p>
                                </div>
                            </div>
                        </div>
                        <!--NUMERO REFERENCIA ADICIONAL-->
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.numeroReferenciaAdicional, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMRONumeroReferenciaAdicional"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!--DATOS DEL VENDEDOR-->
                    <div class="row">
                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.cliente.responsableComercial, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMROResponsableComercial"></p>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.cliente.supervisorComercial, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMROSupervisorComercial"></p>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-6 col-lg-4">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.cliente.asistenteServicioCliente, htmlAttributes: new { @class = "control-label col-xs-4" })
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMROAsistenteServicioCliente"></p>
                                </div>
                            </div>
                        </div>
                    </div>



                    <fieldset>
                        <legend id="divpedido_direccionEntrega">Datos de Entrega:</legend>

                        <!--DIRECCION ENTREGA-->
                        <div class="row">

                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    @Html.LabelFor(p => vPed.ubigeoEntrega, htmlAttributes: new { @class = "control-label col-xs-4" })
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verMROUbigeoEntrega"></p>
                                    </div>
                                </div>
                            </div>

                            <!--DIRECCION ENTREGA -->
                            <div class="col-sm-6 col-lg-8">
                                <div class="form-group">
                                    @Html.LabelFor(p => vPed.direccionEntrega.descripcion, htmlAttributes: new { @class = "control-label col-xs-2" })
                                    <div class="col-xs-10">
                                        <p class="form-control-static" id="verMRODireccionEntrega"></p>
                                    </div>
                                </div>
                            </div>

                        </div>


                        <!--CONTACTO y FECHAS ENTREGA -->
                        <div class="row">
                            <!--CONTACTO ENTREGA-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    @Html.LabelFor(p => vPed.direccionEntrega.contacto, htmlAttributes: new { @class = "control-label col-xs-4" })
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verMROContactoEntrega"></p>
                                    </div>
                                </div>
                            </div>
                            <!--TELEFONO CONTACTO ENTREGA-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    @Html.LabelFor(p => vPed.direccionEntrega.telefono, htmlAttributes: new { @class = "control-label col-xs-4" })
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verMROTelefonoContactoEntrega"></p>
                                    </div>
                                </div>
                            </div>
                            <!--FECHAS ENTREGA-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">

                                    @Html.LabelFor(p => vPed.fechaHorarioEntrega, htmlAttributes: new { @class = "control-label col-xs-4" })
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verMROFechaHorarioEntrega"></p>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </fieldset>


                    <fieldset>
                        <legend id="divpedido_direccionEntrega">Datos de Solicitud:</legend>

                        <div class="row">
                            <!--CONTACTO PEDIDO-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    @Html.LabelFor(p => vPed.contactoPedido, htmlAttributes: new { @class = "control-label col-xs-4" })
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verMROContactoPedido"></p>
                                    </div>
                                </div>
                            </div>
                            <!--TELEFONO CORREO CONTACTO PEDIDO-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    @Html.LabelFor(p => vPed.telefonoCorreoContactoPedido, htmlAttributes: new { @class = "control-label col-xs-4" })
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verMROTelefonoCorreoContactoPedido"></p>
                                    </div>
                                </div>
                            </div>
                            <!--FECHA HORA SOLICITUD-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    @Html.LabelFor(p => vPed.fechaHoraSolicitud, htmlAttributes: new { @class = "control-label col-xs-4" })
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verMROFechaHoraSolicitud"></p>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </fieldset>


                    <!--Otros datos -->
                    <fieldset>
                        <legend id="divpedido_direccionEntrega">Estado Pedido:</legend>
                        <div class="row">
                            <!--Estado-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    <label for="estado" class="control-label col-xs-4">Estado:</label>
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verMROEstado"></p>
                                        @*<a id="lnkVerHistorial" href="#">Ver Historial</a>*@
                                    </div>
                                </div>
                            </div>
                            <!--Modificado POR-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    <label for="modificado" class="control-label col-xs-4">Modificado Por:</label>
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verMROModificadoPor"></p>
                                    </div>
                                </div>
                            </div>
                            <!--Observación Estado-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    <label for="modificado" class="control-label col-xs-4">Comentario Estado:</label>
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verMROObservacionEstado">
                                        </p>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </fieldset>

                    <fieldset>
                        <legend id="divpedido_direccionEntrega">Estado Crediticio del Pedido:</legend>
                        <div class="row">
                            <!--Estado-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    <label for="estado" class="control-label col-xs-4">Estado:</label>
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verMROEstadoCrediticio"></p>
                                        @*<a id="lnkVerHistorialCrediticio" href="#">Ver Historial</a>*@
                                    </div>
                                </div>
                            </div>
                            <!--Modificado POR-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    <label for="modificado" class="control-label col-xs-4">Modificado Por:</label>
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verMROModificadoCrediticioPor"></p>
                                    </div>
                                </div>
                            </div>
                            <!--Observación Estado-->
                            <div class="col-sm-6 col-lg-4">
                                <div class="form-group">
                                    <label for="modificado" class="control-label col-xs-4">Comentario Estado:</label>
                                    <div class="col-xs-8">
                                        <p class="form-control-static" id="verMROObservacionEstadoCrediticio">
                                        </p>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </fieldset>

                    <table id="tableDetallePedidoMRO" class="table" data-editing="false"
                           data-editing-show-text='<span class="fooicon fooicon-pencil" aria-hidden="true"></span> Editar Detalle'
                           data-editing-allow-add="false"
                           data-editing-allow-delete="false"
                           data-editing-allow-edit="false"
                           data-sorting="true"
                           data-show-toggle="false"
                           data-editing-hide-text="Finalizar edición"
                           data-editing-add-text="Descartar cambios">
                        <thead>
                            <tr>
                                <th data-name="indicadorAprobacion" data-sortable="false"></th>
                                <th data-name="proveedor" data-sortable="false">Prov.</th>
                                <th data-name="codigo" data-sortable="false" data-breakpoints="xs">Código</th>
                                <th data-name="producto" data-sortable="false">Producto / Descripción</th>
                                <th data-name="presentacion" data-sortable="false" data-breakpoints="xs">Unidad</th>
                                <th data-name="imagen" data-sortable="false" data-breakpoints="xs sm">Imagen</th>
                                <th data-name="precioLista" data-visible="false" data-sortable="false" data-breakpoints="xs sm">Precio Lista</th>
                                <th data-name="porcentajeDescuentoMostrar" data-sortable="false" data-breakpoints="xs sm">Dscto % al P. Lista</th>
                                @if (vPed.usuario.esCliente)
                                {
                                    <th data-name="precioNeto" data-sortable="false" data-visible="false" data-breakpoints="xs sm">Precio Neto</th>
                                    <th data-name="margen" data-visible="true" data-sortable="false" data-breakpoints="xs sm" style="width:60px">Mg %</th>
                                }
                                else
                                {
                                    <!--Si no es cliente-->
                                    <th data-name="precioNeto" data-sortable="false" data-breakpoints="xs sm">Precio Neto</th>
                                    if (vPed.usuario.visualizaMargen)
                                    {
                                        <th data-name="margen" data-visible="true" data-sortable="false" data-breakpoints="xs sm" style="width:60px">Mg %</th>
                                    }
                                    else
                                    {
                                        <th data-name="margen" data-visible="false" data-sortable="false" data-breakpoints="xs sm" style="width:60px">Mg %</th>
                                    }
                                }

                                <th data-name="flete" data-sortable="false" data-breakpoints="xs sm">Flete</th>
                                <th data-name="precioUnitario" data-sortable="false" data-breakpoints="xs sm">Precio Unit.</th>

                                <!--     @if (vPed.usuario.creaDocumentosVenta)
                                     {
                                         <th data-name="precioUnitarioVenta" data-visible="true" data-sortable="false" data-breakpoints="xs sm">Precio Unit Venta.</th>
                                         }
                                         else
                                         {
                                                         <th data-name="precioUnitarioVenta" data-visible="false" data-sortable="false" data-breakpoints="xs sm">Precio Unit Venta.</th>
                                         }
                                -->
                                <th data-name="cantidad" data-sortable="false" data-visible="true" data-breakpoints="xs sm">Cant.</th>
                                <th data-name="cantidad" data-sortable="false" data-visible="true" data-breakpoints="xs sm">Cant. Pend. Entrega.</th>
                                <th data-name="subTotal" data-sortable="false" data-visible="true" data-breakpoints="xs sm">Sub Total</th>
                                <th data-name="observaciones" data-sortable="false" data-visible="true" data-breakpoints="xs sm">Observaciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>


                    <div class="row" style="margin-right: 10px">
                        <div class="col-sm-6 col-lg-9">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.observaciones, htmlAttributes: new { @class = "control-label col-xs-2" })
                                <div class="col-xs-10">
                                    <p class="form-control-static" id="verMROObservaciones">
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-6 col-lg-3" id="montosTotalesDiv">

                            <div class="form-group">
                                <div class="pull-right">
                                    <span class="totales">Subtotal: S/ </span>
                                    <span class="totales" id="verMROMontoSubTotal"></span>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="pull-right">
                                    <span class="totales">IGV 18%: S/ </span>
                                    <span class="totales" id="verMROMontoIGV"></span>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="pull-right">
                                    <span class="totales">TOTAL: S/ </span>
                                    <span class="totales" id="verMROMontoTotal"></span>
                                </div>
                            </div>

                        </div>

                    </div>

                    <div class="row">
                        <div class="col-sm-6 col-lg-9">
                            <div class="form-group">
                                <label for="verMROCondicionesPago" class="control-label col-xs-2">Condición de Pago:</label>
                                <div class="col-xs-8">
                                    <p class="form-control-static" id="verMROCondicionesPago">
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-6 col-lg-9">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.observacionesGuiaRemision, htmlAttributes: new { @class = "control-label col-xs-2" })
                                <div class="col-xs-10">
                                    <p class="form-control-static" id="verMROObservacionesGuiaRemision">
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-6 col-lg-9">
                            <div class="form-group">
                                @Html.LabelFor(p => vPed.observacionesFactura, htmlAttributes: new { @class = "control-label col-xs-2" })
                                <div class="col-xs-10">
                                    <p class="form-control-static" id="verMROObservacionesFactura">
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="row" style="margin-right: 10px">
                        <div class="col-sm-6 col-lg-9">
                            <div class="form-group">
                                <label for="verMRONombreArchivos" class="control-label col-xs-2">Archivos Adjuntos:</label>
                                <div class="col-xs-10">
                                    <ul id="verMRONombreArchivos"><li>as</li></ul>
                                </div>
                            </div>
                        </div>
                    </div>


                    @if (vPed.usuario.tomaPedidos)
                    {
                        <!--
                        <div class="row">
                            <div class="col-sm-6 col-lg-9">
                                <div class="form-group">
                                    <label for="archivoAdjunto" class="control-label col-xs-2">Adjunto:</label>
                                    <div class="col-xs-3">
                                        <div class="upload-btn-wrapper">
                                            <button class="btn btn-primary">Adjuntar Archivo(s)</button>
                                            <input type="file" class="form-control" name="files" id="files" accept=".*" multiple>
                                        </div>
                                    </div>
                                    <div class="col-xs-3">
                                        <div><button id="btnGuardarArchivosAdjuntos" type="button" class="btn btn-primary">Guardar Archivos Adjuntos</button></div>
                                    </div>
                                </div>
                            </div>
                        </div>-->

                    }



                </form>
            </div>

            <div class="modal-footer">
                <div class="pull-left">

                </div>

                <div class="pull-right">
                    <button type="button" id="btnOcultarPedidoReadOnly" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>
</div>

@if (!agregadoPedidoModals) { 
    <span id="spnProductoDescontinuado" style="display: none;">
        @Html.Partial("../Producto/_LabelRestringido")
    </span>

    <span id="spnDetalleRestringido" style="display: none;">
        @Html.Partial("../Pedido/_LabelDetalleRestringido")
    </span>

    <span id="spnDescripcionLargaInfo" style="display: none;">
        @Html.Partial("../Producto/_LabelDescripcionLarga")
    </span>
}

<script type="text/javascript">

    function funcionesModalPedidoReadOnly() {
        $(document).on('click', ".verModalPedidoReadOnly", function () {
            var idPedido = $(this).attr("idPedido");

            $.ajax({
                url: "/Pedido/Show",
                data: {
                    idPedido: idPedido,
                    soloLectura: 1
                },
                type: 'POST',
                dataType: 'JSON',
                error: function (detalle) {
                    //alert("Ocurrió un problema al obtener el detalle del Pedido N° " + numeroPedido + ".");
                    $('body').loadingModal('hide');
                    mostrarMensajeErrorProceso(detalle.responseText);
                },
                success: function (resultado) {
                    $('body').loadingModal('hide');
                    //var cotizacion = $.parseJSON(respuesta);
                    var pedido = resultado.pedido;
                    var usuario = resultado.usuario;
                    var isOwner = resultado.isOwner;
                    var serieDocumentoElectronicoList = resultado.serieDocumentoElectronicoList;
                    viendoPedidoRestringido = false;
                    pedidoItemsRestringidos = [];
                    //  var usuario = resultado.usuario;

                    $("#verMROIdPedido").val(pedido.idPedido);

                    

                    $("#fechaEntregaDesdeProgramacion").val(invertirFormatoFecha(pedido.fechaEntregaDesde.substr(0, 10)));
                    $("#fechaEntregaHastaProgramacion").val(invertirFormatoFecha(pedido.fechaEntregaHasta.substr(0, 10)));
                    $("#fechaProgramaciontmp").val(invertirFormatoFecha(pedido.fechaEntregaDesde.substr(0, 10)));
                    //Important


                    var numeroPedido = pedido.numeroPedidoString;

                    if (pedido.numeroGrupoPedidoString == "") {
                        numeroPedido = pedido.numeroPedidoString;
                    }
                    else {
                        numeroPedido = pedido.numeroPedidoString + " (" + pedido.numeroGrupoPedidoString + ")";
                    }

                    if (pedido.truncado == 1) {
                        numeroPedido = numeroPedido + '<br/><span style="color:red; font-weight: bold;">TRUNCADO</span>';
                    }

                    $("#verMRONumero").html(numeroPedido);

                    if (pedido.cotizacion_tipoCotizacion == 0) {
                        $("#verMROCotizacionCodigo").html(pedido.cotizacion_numeroCotizacionString);
                    }
                    else if (pedido.cotizacion_tipoCotizacion == 1) {
                        $("#verMROCotizacionCodigo").html(pedido.cotizacion_numeroCotizacionString + " (Puntual)");
                    }
                    else if (pedido.cotizacion_tipoCotizacion == 2) {
                        $("#verMROCotizacionCodigo").html(pedido.cotizacion_numeroCotizacionString + " (Trivial)");
                    }



                    $("#verMROTipoPedido").html(pedido.tiposPedidoString);

                    $("#verMROResponsableComercial").html(pedido.cliente_responsableComercial_codigoDescripcion + " " + pedido.cliente_responsableComercial_usuario_email);
                    $("#verMROSupervisorComercial").html(pedido.cliente_supervisorComercial_codigoDescripcion + " " + pedido.cliente_supervisorComercial_usuario_email);
                    $("#verMROAsistenteServicioCliente").html(pedido.cliente_asistenteServicioCliente_codigoDescripcion + " " + pedido.cliente_asistenteServicioCliente_usuario_email);

                    /*if (pedido.tipoPedido == TIPO_PEDIDO_VENTA_TRASLADO_INTERNO_ENTREGADO.charCodeAt(0)) {
                        $("#divReferenciaCliente").hide();
                        $("#divCiudadSolicitante").show();
                        $("#verMROCiudadSolicitante").html(pedido.cliente.ciudad.nombre);
                    }
                    else {*/
                    $("#divReferenciaCliente").show();
                    $("#divCiudadSolicitante").hide();
                    //}

                    $("#verMROCondicionesPago").html(pedido.textoCondicionesPago);

                    $("#verMROFechaHorarioEntrega").html(pedido.fechaHorarioEntrega);

                    $("#verMROCiudad").html(pedido.ciudad_nombre);
                    $("#verMROIdCliente").val(pedido.cliente_idCliente);
                    $("#verMROCliente").html(pedido.cliente_codigoRazonSocial);


                    $("#verMROGrupoCliente").html(pedido.grupoCliente_nombre == null ? "" : pedido.grupoCliente_nombre);


                    $("#verMRONumeroReferenciaCliente").html(pedido.numeroReferenciaCliente);
                    $("#verMRONumeroReferenciaAdicional").html(pedido.numeroReferenciaAdicional);
                    $("#verMRONumeroRequerimiento").html(pedido.numeroRequerimiento);

                    $("#verMROFechaEntregaExtendida").val(pedido.fechaEntregaExtendidaString);

                    $("#verMRODireccionEntrega").html(pedido.direccionEntrega_descripcion);
                    $("#verMROTelefonoContactoEntrega").html(pedido.direccionEntrega_telefono);
                    $("#verMROContactoEntrega").html(pedido.direccionEntrega_contacto);

                    $("#verMROUsuarioCreacion").html(pedido.usuario_nombre);
                    $("#verMROFechaHoraRegistro").html(pedido.fechaHoraRegistro);

                    $("#verMROUbigeoEntrega").html(pedido.ubigeoEntrega.ToString);

                    $("#verMROContactoPedido").html(pedido.contactoPedido);
                    $("#verMROTelefonoCorreoContactoPedido").html(pedido.telefonoCorreoContactoPedido);




                    $("#verMROFechaHoraSolicitud").html(pedido.fechaHoraSolicitud);

                    $("#verMROEstado").html(pedido.seguimientoPedido_estadoString);
                    $("#verMROModificadoPor").html(pedido.seguimientoPedido_usuario_nombre);
                    $("#verMROObservacionEstado").html(pedido.seguimientoPedido_observacion);

                    $("#verMROEstadoCrediticio").html(pedido.seguimientoCrediticioPedido_estadoString);
                    $("#verMROModificadoCrediticioPor").html(pedido.seguimientoCrediticioPedido_usuario_nombre);
                    $("#verMROObservacionEstadoCrediticio").html(pedido.seguimientoCrediticioPedido_observacion);


                    $("#verMROObservaciones").html(pedido.observaciones);
                    $("#verMROObservacionesFactura").html(pedido.observacionesFactura);
                    $("#verMROObservacionesGuiaRemision").html(pedido.observacionesGuiaRemision);
                    $("#verMROMontoSubTotal").html(Number(pedido.montoSubTotal).toFixed(cantidadDecimales));
                    $("#verMROMontoIGV").html(Number(pedido.montoIGV).toFixed(cantidadDecimales));
                    $("#verMROMontoTotal").html(Number(pedido.montoTotal).toFixed(cantidadDecimales));
                    $("#documentoVenta_observaciones").val(pedido.observacionesFactura);

                    /*      $("#verMROMontoSubTotalVenta").html(Number(pedido.venta.subTotal).toFixed(cantidadDecimales));
                          $("#verMROMontoIGVVenta").html(Number(pedido.venta.igv).toFixed(cantidadDecimales));
                          $("#verMROMontoTotalVenta").html(Number(pedido.venta.total).toFixed(cantidadDecimales));
          */
                    //  nombreArchivos

                    $("#nombreArchivos > li").remove().end();


                    for (var i = 0; i < pedido.pedidoAdjuntoList.length; i++) {
                        var liHTML = '<a href="javascript:mostrar();" class="descargar">' + pedido.pedidoAdjuntoList[i].nombre + '</a>';
                        $('<li />').html(liHTML).appendTo($('#nombreArchivos'));
                    }


                    $("#verMRONombreArchivos > li").remove().end();


                    for (var i = 0; i < pedido.pedidoAdjuntoList.length; i++) {
                        var liHTML = '<a href="javascript:mostrar();" class="descargar btnDescargarArchivoAdjunto" idArchivoAdjunto="' + pedido.pedidoAdjuntoList[i].idArchivoAdjunto + '">' + pedido.pedidoAdjuntoList[i].nombre + '</a>';
                        //$('<li />').html(liHTML).appendTo($('#nombreArchivos'));
                        $('#verMRONombreArchivos').append($('<li />').html(liHTML));
                    }


                    $("#tableDetallePedidoMRO > tbody").empty();

                    FooTable.init('#tableDetallePedidoMRO');

                    $("#formVerGuiasRemision").html("");
                    $("#formVerNotasIngreso").html("");

                    var d = '';
                    var lista = pedido.pedidoDetalleList;
                    var tieneProductoRestringido = false;
                    var tienePendienteAtencion = false;
                    for (var i = 0; i < lista.length; i++) {

                        var imgIndicadorAprobacion = '<a data-toggle="tooltip" title="Aprobado"> <img class="table-product-img"  src="/images/semaforo_verde_small.png"  srcset="semaforo_verde_min.png 2x"/></a>';
                        if (lista[i].indicadorAprobacion == 2)
                            imgIndicadorAprobacion = '<a data-toggle="tooltip" title="Pendiente Aprobación"> <img class="table-product-img" src="/images/semaforo_naranja_small.png" srcset="semaforo_naranja_min.png 2x"/></a>';
                        else if (lista[i].indicadorAprobacion == 3)
                            imgIndicadorAprobacion = '<a data-toggle="tooltip" title="Pendiente Aprobación"><img class="table-product-img " src="/images/semaforo_rojo_small.png" srcset="semaforo_rojo_min.png 2x"/></a>';


                        var observacion = lista[i].observacion == null || lista[i].observacion == 'undefined' ? '' : lista[i].observacion;

                        var descontinuadoLabel = "";
                        if (lista[i].producto.descontinuado == 1) {
                            tieneProductoRestringido = true;

                            if (lista[i].producto.motivoRestriccion != null) {
                                lista[i].producto.motivoRestriccion = lista[i].producto.motivoRestriccion.trim();

                                $("#spnProductoDescontinuado .lblAlertaProductoDescontinuado ").removeClass("tooltip-motivo-restriccion");
                                if (lista[i].producto.motivoRestriccion != "") {
                                    $("#spnProductoDescontinuado .lblAlertaProductoDescontinuado ").addClass("tooltip-motivo-restriccion");
                                    $("#spnProductoDescontinuado .lblAlertaProductoDescontinuado .tooltip-label-text").html(lista[i].producto.motivoRestriccion);
                                }
                            }

                            descontinuadoLabel = "<br/>" + $("#spnProductoDescontinuado").html();
                        }


                        var restringidoLabel = "";
                        if (lista[i].cantidadPermitida < lista[i].cantidad) {
                            if (lista[i].observacionRestriccion != null) {
                                lista[i].observacionRestriccion = lista[i].observacionRestriccion.trim();

                                $("#spnDetalleRestringido .lblAlertaDanger .cantidadPermitidaAtender").html(lista[i].cantidadPermitida);
                                $("#spnDetalleRestringido .lblAlertaDanger ").removeClass("tooltip-motivo-restriccion");
                                if (lista[i].observacionRestriccion != "") {
                                    $("#spnDetalleRestringido .lblAlertaDanger ").addClass("tooltip-motivo-restriccion");
                                    $("#spnDetalleRestringido .lblAlertaDanger .tooltip-label-danger-text").html(lista[i].observacionRestriccion);
                                }
                            }

                            restringidoLabel = "<br/>" + $("#spnDetalleRestringido").html();
                        }

                        var descripcionLargaLabel = "";
                        if (lista[i].producto.descripcionLarga != null && lista[i].producto.descripcionLarga.trim() != "") {

                            lista[i].producto.descripcionLarga = lista[i].producto.descripcionLarga.trim();

                            $("#spnDescripcionLargaInfo .lblInfoDescripcionLarga ").removeClass("tooltip-motivo-restriccion");

                            $("#spnDescripcionLargaInfo .lblInfoDescripcionLarga ").addClass("tooltip-motivo-restriccion");
                            $("#spnDescripcionLargaInfo .lblInfoDescripcionLarga .tooltip-label-text").html(lista[i].producto.descripcionLarga);

                            descripcionLargaLabel = "&nbsp;" + $("#spnDescripcionLargaInfo").html();
                        }


                        if (lista[i].cantidadPendienteAtencion > 0) {
                            tienePendienteAtencion = true;
                        }

                        d += '<tr>' +
                            '<td>' + imgIndicadorAprobacion + '</td>' +
                            '<td>' + lista[i].producto.proveedor + '</td>' +
                            '<td>' + lista[i].producto.sku + descontinuadoLabel + '</td>' +
                            '<td>' + lista[i].producto.descripcion + descripcionLargaLabel + '</td>' +
                            '<td>' + lista[i].unidad + '</td>' +
                            '<td class="column-img"><img class="table-product-img" src="data:image/png;base64,' + lista[i].producto.image + '"> </td>' +
                            '<td>' + lista[i].precioLista.toFixed(cantidadDecimales) + '</td>' +
                            '<td>' + lista[i].porcentajeDescuentoMostrar.toFixed(cantidadDecimales) + ' %</td>' +
                            '<td>' + lista[i].precioNeto.toFixed(cantidadCuatroDecimales) + '</td>' +
                            '<td>' + lista[i].margen.toFixed(cantidadDecimales) + ' %</td>' +
                            '<td>' + lista[i].flete.toFixed(cantidadDecimales) + '</td>' +
                            '<td>' + lista[i].precioUnitario.toFixed(cantidadCuatroDecimales) + '</td>' +
                            //       '<td>' + lista[i].precioUnitarioVenta.toFixed(cantidadCuatroDecimales) + '</td>' +
                            '<td>' + lista[i].cantidad + restringidoLabel + '</td>' +
                            '<td>' + lista[i].cantidadPendienteAtencion + '</td>' +
                            '<td>' + lista[i].subTotal.toFixed(cantidadDecimales) + '</td>' +
                            '<td>' + observacion + '</td>' +
                            '</tr>';
                    }




                    $("#verMRORazonSocialSunat").html(pedido.cliente_razonSocialSunat);
                    $("#verMRORUC").html(pedido.cliente_ruc);
                    $("#verMRODireccionDomicilioLegalSunat").html(pedido.cliente_direccionDomicilioLegalSunat);
                    $("#verMROCodigo").html(pedido.cliente_codigo);

                    $("#documentoVenta_observaciones").val(pedido.observacionesFactura);
                    $("#verMROCorreoEnvioFactura").html(pedido.cliente_correoEnvioFactura);

                    //
                    // sleep
                    $("#tableDetallePedidoMRO").append(d);


                    


                    $("#modalPedidoReadOnly").modal('show');
                }
            });
        });
    };


    if (window.addEventListener) // W3C standard
    {
        window.addEventListener('load', funcionesModalPedidoReadOnly, false); // NB **not** 'onload'
    }
    else if (window.attachEvent) // Microsoft
    {
        window.attachEvent('onload', funcionesModalPedidoReadOnly);
    }
</script>
